#!name=QQ音乐自动签到
#!desc=单账号QQ音乐自动签到\n每日签到+VIP成长值+任务完成
#!author=SXIE-ai
#!homepage=https://github.com/SXIE-ai/Loon
#!icon=https://y.qq.com/favicon.ico
#!openUrl=https://github.com/SXIE-ai/Loon
#!tag=签到,音乐
#!system=iOS
#!system_version=15
#!date=2024-01-20
#!version=2.0.0
#!loon_version=3.2.0
#!update_url=https://raw.githubusercontent.com/SXIE-ai/Loon/main/plugins/QQMusic.plugin/plugin.conf

[General]
name = QQ音乐自动签到（单账号）
author = SXIE-ai
desc = 单账号QQ音乐自动签到插件
version = 2.0.0
enabled = true
hide-vpn-icon = false
platform = ios
min-loon-version = 3.2.0
min-ios-version = 15.0

[Argument]
# 用户配置参数
cookie_switch=switch, true, false, tag=Cookie获取开关, desc=是否自动获取Cookie
notification_switch=switch, true, false, tag=通知开关, desc=是否显示签到通知
checkin_time=select, "09:10", "08:00", "10:00", "12:00", "14:00", "16:00", "18:00", "20:00", "22:00", tag=签到时间, desc=选择每日自动签到的时间
enable_vip=switch, true, false, tag=VIP签到, desc=是否执行VIP成长值签到

[Script]
# 定时签到（使用参数化时间）
cron "{{checkin_time}}" script-path=https://raw.githubusercontent.com/SXIE-ai/Loon/main/plugins/QQMusic.plugin/qqmusic.js, timeout=300, tag=QQ音乐自动签到, argument=auto

# 自动获取Cookie（受开关控制）
http-request ^https?://(y|c|u)\.qq\.com/ script-path=https://raw.githubusercontent.com/SXIE-ai/Loon/main/plugins/QQMusic.plugin/qqmusic.js, tag=QQ音乐Cookie获取, requires-body=true, argument=cookie, enabled={{cookie_switch}}

# 状态面板
panel = script-name=QQ音乐签到, script-path=https://raw.githubusercontent.com/SXIE-ai/Loon/main/plugins/QQMusic.plugin/qqmusic.js, update-interval=3600, argument=panel

# 手动触发签到
http-request ^https?://trigger\.qqmusic\.local/ script-path=https://raw.githubusercontent.com/SXIE-ai/Loon/main/plugins/QQMusic.plugin/qqmusic.js, tag=QQ音乐手动签到, argument=manual

# 手动获取Cookie
http-request ^https?://getcookie\.qqmusic\.local/ script-path=https://raw.githubusercontent.com/SXIE-ai/Loon/main/plugins/QQMusic.plugin/qqmusic.js, tag=QQ音乐手动获取Cookie, argument=getcookie

# 清理Cookie
http-request ^https?://clearcookie\.qqmusic\.local/ script-path=https://raw.githubusercontent.com/SXIE-ai/Loon/main/plugins/QQMusic.plugin/qqmusic.js, tag=QQ音乐清理Cookie, argument=clearcookie

[MITM]
# 需要解密的域名
hostname = y.qq.com, c.y.qq.com, u.y.qq.com, *.qq.com
skip-server-cert-verify = true
enable-http2 = true
enable-quic-fallback = true